#:import platform kivy.platform
<ColorReaderScreen>:
    id: readerScreen
    Painter:
        id: painter
        x: root.width * 0.2
        y: root.height * 0.15
        width: root.width * 0.8
        height: root.height * 0.85

    BoxLayout:
        x: 0
        y: root.height * 0.15
        width: root.width * 0.2
        height: root.height * 0.85
        orientation: 'vertical'
        Button:
            text: 'Settings'
            on_release:
                painter.inSettings = True 
                print app.open_settings()
        Button:
            text: 'Go to graph'
            on_release: 
                app.writeSpotsToConfig()
                app.goto_graph()
        ToggleButton:
            id: blankToggle
            text: 'Blank'
            group: 'blank/sample'
            on_release:
                painter.spotConcs[painter.boxNo - 1] = 'Blank'
                if self.state == 'down':\ 
                readerScreen.valTextWasModifiedByToggle = True
                sampleValText.text = '-'
        ToggleButton:
            id: sampleToggle
            text: 'Sample'
            group: 'blank/sample'
            on_release:
                print self.state
                painter.spotConcs[painter.boxNo - 1] = 'Sample'
                if self.state == 'down':\
                readerScreen.valTextWasModifiedByToggle = True
                sampleValText.text = '-'
        TextInput:
            id: sampleValText
            text: '0.1'
            font_size: self.height * 0.8
            on_text:
                readerScreen.updateText()
        TextInput:
            id: boxSizeText
            text: '15'
            font_size: self.height * 0.8
        
        RelativeLayout:
            cols: 3
            row: 3
            Button:
                size_hint_x: None
                size_hint_y: None
                x: self.parent.width * 0.33333
                y: self.parent.height * 0.66667
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Up'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: painter.startMoveBox(0, 1)
                on_release: painter.stopMoveBox()
            Button:
                size_hint_x: None
                size_hint_y: None
                x: self.parent.width * 0.33333
                y: 0
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Down'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: painter.startMoveBox(0, -1)
                on_release: painter.stopMoveBox()
            Button:
                size_hint_x: None
                size_hint_y: None
                x: 0
                y: self.parent.height * 0.33333 
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Left'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: painter.startMoveBox(-1, 0)
                on_release: painter.stopMoveBox()
            Button:
                size_hint_x: None
                size_hint_y: None
                x: self.parent.width * 0.66667
                y: self.parent.height * 0.33333
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Right'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: painter.startMoveBox(1, 0)
                on_release: painter.stopMoveBox()

    BoxLayout:
        width: root.width
        y: root.height * 0.1
        height: root.height * 0.05
        ColorReaderToggleButton:
            text: painter.buttonText[0]
            state: 'down'
            on_press: painter.boxNo = 1
        ColorReaderToggleButton:
            text: painter.buttonText[1]
            on_press: painter.boxNo = 2
        ColorReaderToggleButton:
            text: painter.buttonText[2]
            on_press: painter.boxNo = 3
        ColorReaderToggleButton:
            text: painter.buttonText[3]
            on_press: painter.boxNo = 4
        ColorReaderToggleButton:
            text: painter.buttonText[4]
            on_press: painter.boxNo = 5

    BoxLayout:
        width: root.width
        y: root.height * 0.05
        height: root.height * 0.05
        ColorReaderToggleButton:
            text: painter.buttonText[5]
            on_press:
                painter.boxNo = 6
        ColorReaderToggleButton:
            text: painter.buttonText[6]
            on_press: painter.boxNo = 7
        ColorReaderToggleButton:
            text: painter.buttonText[7]
            on_press: painter.boxNo = 8
        ColorReaderToggleButton:
            text: painter.buttonText[8]
            on_press: painter.boxNo = 9
        ColorReaderToggleButton:
            text: painter.buttonText[9]
            on_press: painter.boxNo = 10

    BoxLayout:
        width: root.width
        y: 0
        height: root.height * 0.05
        ColorReaderToggleButton:
            text: painter.buttonText[10]
            on_press: painter.boxNo = 11
        ColorReaderToggleButton:
            text: painter.buttonText[11]
            on_press: painter.boxNo = 12
        ColorReaderToggleButton:
            text: painter.buttonText[12]
            on_press: painter.boxNo = 13
        ColorReaderToggleButton:
            text: painter.buttonText[13]
            on_press: painter.boxNo = 14
        ColorReaderToggleButton:
            text: painter.buttonText[14]
            on_press: painter.boxNo = 15


<GraphScreen>:
    BoxLayout:
        size: root.size
        orientation: 'vertical'
        MyGraph:
            id: graph
        Button:
            id: analyer_btn
            size_hint_y: None
            height: root.height * 0.25
            text: 'Go to analyser'
            on_release:
                app.goto_color_reader()
                print R2.x
                print R2.y
                print R2.text_size
                print R2.height
                print R2.width
    Label:
        id: LSR
        x: root.width * 0.2
        y: root.height * 0.8
        width: root.width * 0.3
        height: root.height * 0.05
        text_size: self.size
        font_size: self.height * 0.7
    Label:
        id: R2
        x: root.width * 0.2
        y: root.height * 0.7
        width: root.width * 0.3
        height: root.height * 0.05
        text_size: self.size
        font_size: self.height * 0.7


<FileChooserScreen>:
    BoxLayout:
        size: root.size
        orientation: 'vertical'
        FileChooserListView:
            id: filechooser
            path: ('/Users/alistairmckelvie/Projects/analyzer' if platform=='macosx' else '/mnt/sdcard/DCIM' if platform=='android' else 'D:/Projects/analyser' if platform=='win' else '.')
        Button:
            size_hint_y: 0.1
            text: 'Load'
            on_release:
                app.readSpotsFromConfig()
                app.goto_color_reader(filechooser.selection[0])
       
 
<ColorReaderToggleButton@ToggleButton>:
    group: 'select'
    allow_no_boxNo: False
    font_size: self.height * 0.35
    halign: 'center'
    valign: 'middle'
    markup: True
