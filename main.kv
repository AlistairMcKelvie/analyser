#:import platform kivy.platform
#:import sendMail sendGmail.sendMail
<ColorReaderScreen>:
    id: readerScreen
    ColorReader:
        id: colorReader
        x: root.width * 0.2
        y: root.height * 0.15
        width: root.width * 0.8
        height: root.height * 0.85

    BoxLayout:
        x: 0
        y: root.height * 0.15
        width: root.width * 0.2
        height: root.height * 0.85
        orientation: 'vertical'
        Button:
            text: 'Go to graph'
            on_release: 
                app.writeSpotsToConfig()
                app.goto_graph() 
        TextInput:
            text: '20'
            font_size: self.height * 0.8
            on_text: self.text=colorReader.updateSpotSize(self.text)
        Label:
            text: 'Spot size'
            size_hint_y: 0.3
        TextInput:
            id: sampleValText
            text: '-'
            font_size: self.height * 0.8
            on_text:
                readerScreen.updateConcText()
        Label:
            text: 'Std Conc'
            size_hint_y: 0.3
        Button:
            text: 'Send Mail'
            on_release: sendMail(['alistair.mckelvie@gmail.com'], 'test', 'test')
        ToggleButton:
            id: blankToggle
            text: 'Blank'
            group: 'blank/sample'
            state: 'down'
            on_release:
                colorReader.currentSpotType = 'Blank'
                colorReader.currentSpotConc = 0
                if self.state == 'down':\ 
                readerScreen.valTextWasModifiedByToggle = True
                sampleValText.text = '-'
        ToggleButton:
            id: sampleToggle
            text: 'Sample'
            group: 'blank/sample'
            on_release:
                colorReader.currentSpotType = 'Sample'
                colorReader.currentSpotConc = 9999
                if self.state == 'down':\
                readerScreen.valTextWasModifiedByToggle = True
                sampleValText.text = '-'
        
        RelativeLayout:
            cols: 3
            row: 3
            Button:
                size_hint_x: None
                size_hint_y: None
                x: self.parent.width * 0.33333
                y: self.parent.height * 0.66667
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Up'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: colorReader.startMoveBox(0, 1)
                on_release: colorReader.stopMoveBox()
            Button:
                size_hint_x: None
                size_hint_y: None
                x: self.parent.width * 0.33333
                y: 0
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Down'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: colorReader.startMoveBox(0, -1)
                on_release: colorReader.stopMoveBox()
            Button:
                size_hint_x: None
                size_hint_y: None
                x: 0
                y: self.parent.height * 0.33333 
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Left'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: colorReader.startMoveBox(-1, 0)
                on_release: colorReader.stopMoveBox()
            Button:
                size_hint_x: None
                size_hint_y: None
                x: self.parent.width * 0.66667
                y: self.parent.height * 0.33333
                width: self.parent.width * 0.33333
                height: self.parent.height * 0.33333
                text: 'Right'
                text_size: self.size
                font_size: self.height * 0.7
                halign: 'center'
                valign: 'middle'
                on_press: colorReader.startMoveBox(1, 0)
                on_release: colorReader.stopMoveBox()

    BoxLayout:
        width: root.width
        y: root.height * 0.1
        height: root.height * 0.05
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[0]
            state: 'down'
            on_press: colorReader.currentSpot = 1
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[1]
            on_press: colorReader.currentSpot = 2
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[2]
            on_press: colorReader.currentSpot = 3
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[3]
            on_press: colorReader.currentSpot = 4
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[4]
            on_press: colorReader.currentSpot = 5

    BoxLayout:
        width: root.width
        y: root.height * 0.05
        height: root.height * 0.05
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[5]
            on_press: colorReader.currentSpot = 6
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[6]
            on_press: colorReader.currentSpot = 7
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[7]
            on_press: colorReader.currentSpot = 8
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[8]
            on_press: colorReader.currentSpot = 9
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[9]
            on_press: colorReader.currentSpot = 10

    BoxLayout:
        width: root.width
        y: 0
        height: root.height * 0.05
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[10]
            on_press: colorReader.currentSpot = 11
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[11]
            on_press: colorReader.currentSpot = 12
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[12]
            on_press: colorReader.currentSpot = 13
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[13]
            on_press: colorReader.currentSpot = 14
        ColorReaderToggleButton:
            text: colorReader.spotButtonText[14]
            on_press: colorReader.currentSpot = 15


<GraphScreen>:
    BoxLayout:
        size: root.size
        orientation: 'vertical'
        MyGraph:
            id: graph
        Button:
            id: analyer_btn
            size_hint_y: None
            height: root.height * 0.25
            text: 'Go to analyser'
            on_release:
                app.goto_color_reader()
                print R2.x
                print R2.y
                print R2.text_size
                print R2.height
                print R2.width
    Label:
        id: LSR
        x: root.width * 0.2
        y: root.height * 0.8
        width: root.width * 0.3
        height: root.height * 0.05
        text_size: self.size
        font_size: self.height * 0.7
    Label:
        id: R2
        x: root.width * 0.2
        y: root.height * 0.7
        width: root.width * 0.3
        height: root.height * 0.05
        text_size: self.size
        font_size: self.height * 0.7


<FileChooserScreen>:
    BoxLayout:
        size: root.size
        orientation: 'vertical'
        FileChooserListView:
            id: filechooser
            path: ('/Users/alistairmckelvie/Projects/analyzer' if platform=='macosx' else '/mnt/sdcard/DCIM' if platform=='android' else 'D:/Projects/analyser' if platform=='win' else '.')
        Button:
            size_hint_y: 0.1
            text: 'Load'
            on_release:
                app.readSpotsFromConfig()
                app.goto_color_reader(filechooser.selection[0])
       
 
<ColorReaderToggleButton@ToggleButton>:
    group: 'select'
    allow_no_currentSpot: False
    font_size: self.height * 0.35
    halign: 'center'
    valign: 'middle'
    markup: True
